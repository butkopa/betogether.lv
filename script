// Small JS for menu toggle, smooth scroll and form handling
document.addEventListener('DOMContentLoaded', () => {
  // set year in footer
  document.getElementById('year').textContent = new Date().getFullYear();

  // mobile menu toggle
  const menuBtn = document.getElementById('menuBtn');
  const nav = document.getElementById('nav');
  menuBtn && menuBtn.addEventListener('click', () => {
    const expanded = menuBtn.getAttribute('aria-expanded') === 'true';
    menuBtn.setAttribute('aria-expanded', String(!expanded));
    if (!expanded) {
      nav.style.display = 'flex';
    } else {
      nav.style.display = '';
    }
  });

  // smooth scrolling for internal links
  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener('click', e=>{
      const href = a.getAttribute('href');
      if(href === '#' || href === '') return;
      const target = document.querySelector(href);
      if(target){
        e.preventDefault();
        target.scrollIntoView({behavior:'smooth', block:'start'});
        // close mobile nav after click
        if(window.innerWidth <= 900){
          nav.style.display = '';
          menuBtn && menuBtn.setAttribute('aria-expanded','false');
        }
      }
    });
  });

  // Contact form - client-side validation and mailto fallback
  const form = document.getElementById('contactForm');
  const status = document.getElementById('formStatus');

  if(form){
    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      status.textContent = '';
      const name = form.name.value.trim();
      const email = form.email.value.trim();
      const message = form.message.value.trim();

      if(name.length < 2){
        status.textContent = 'Lūdzu ievadi savu vārdu.';
        return;
      }
      if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){
        status.textContent = 'Lūdzu ievadi derīgu e-pasta adresi.';
        return;
      }
      if(message.length < 10){
        status.textContent = 'Ziņa ir pārāk īsa — raksti vismaz 10 rakstzīmes.';
        return;
      }

      // No server set up — use mailto fallback to open user's e-pasta klientu
      const subject = encodeURIComponent(`Vietnes ziņa no ${name}`);
      const body = encodeURIComponent(`Vārds: ${name}\nE-pasts: ${email}\n\n${message}`);
      const mailto = `mailto:tevis@epasts.lv?subject=${subject}&body=${body}`;

      // attempt to open mail client
      window.location.href = mailto;
      status.textContent = 'Tiek atvērts tava e-pasta klients...';
    });
  }
});
